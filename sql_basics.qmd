# SQL Basics

SQL follows a standard syntax for managing and manipulating relational databases. SQL statement is composed of various clauses, each serving a specific purpose.

To make a comment in SQL, you can use two dashes (`--`) followed by the comment text as below:

```sql
-- This is a comment in SQL
```

A SQL query is made up of different clauses.
The general structure of an SQL statement is as follows:
```sql
SELECT column1, column2, ...
FROM table_name
WHERE condition;
```

The `select` statement is used to retrieve data from a database, while the `from` clause specifies the table from which to retrieve the data. The `where` clause is optional and is used to filter the results based on a specified condition. These are SQL keywords and are not case-sensitive, but it is common practice to write them in uppercase for better readability. Also, they should end with a semicolon (`;`) to indicate the end of the statement.

It is not common for a data analyst to create or modify database structures, but it is important to understand the basics of SQL in table creation. So for example, here are some basic SQL operations:

## Table Creation

### Creating a Table

To create a table in SQL, you can use the `CREATE TABLE` statement. Here is an example of how to create a simple table called `Employees` with columns for `EmployeeID`, `FirstName`, `LastName`, and `HireDate`:
```sql
CREATE TABLE Employees (
    EmployeeID INT PRIMARY KEY,
    FirstName VARCHAR(50),
    LastName VARCHAR(50),
    HireDate DATE
);
```
### Inserting Data

To insert data into a table, you can use the `INSERT INTO` statement. Here is an example of how to insert a new employee into the `Employees` table:
```sql
INSERT INTO Employees (EmployeeID, FirstName, LastName, HireDate)
VALUES (1, 'John', 'Doe', '2022-01-15');
```

### Querying Data

To retrieve data from a table, you can use the `SELECT` statement. Here is an example of how to select all columns from the `Employees` table:
```sql
SELECT * FROM Employees;
```

### Updating Data

To update existing data in a table, you can use the `UPDATE` statement. Here is an example of how to update the last name of an employee in the `Employees` table:
```sql
UPDATE Employees
SET LastName = 'Smith'
WHERE EmployeeID = 1;
```

### Deleting Data

To delete data from a table, you can use the `DELETE` statement. Here is an example of how to delete an employee from the `Employees` table:
```sql
DELETE FROM Employees
WHERE EmployeeID = 1;
```

#### Exercises

1. Create a table called `Departments` with columns for `DepartmentID`, `DepartmentName`, and `Location`.

```sql
CREATE TABLE Departments (
    DepartmentID INT PRIMARY KEY,
    DepartmentName VARCHAR(100),
    Location VARCHAR(100)
);
```

2. Insert three departments into the `Departments` table with appropriate values.

```sql
INSERT INTO Departments (DepartmentID, DepartmentName, Location)
VALUES
(1, 'Human Resources', 'Sydney'),
(2, 'Finance', 'Melbourne'),
(3, 'IT', 'Brisbane');
```

3. Write a query to select all departments located in 'Melbourne'.

```sql
SELECT * FROM Departments
WHERE Location = 'Melbourne';
```

4. Update the location of department to 'Queensland'.

```sql
UPDATE Departments
SET Location = 'Queensland'
WHERE DepartmentID = 3;
```

5. Delete a department with a specific `DepartmentID`.

```sql
DELETE FROM Departments
WHERE DepartmentID = 2;
```

Now, you know how to create table in SQL and perform basic operations like inserting, querying, updating, and deleting data! But, you will hardly use these commands as a data analyst. The most important command for you is the data querying and data manipulation commands which we will cover in the next sections.

## SQL for Data Querying and Manipulation

SQL is a powerful language for querying and manipulating data in relational databases. As a data analyst, you will frequently use SQL to extract insights from data stored in databases. In this section, we will cover some of the most commonly used SQL commands for data querying and manipulation.

### Selecting Data

The `SELECT` statement is used to retrieve data from a database. You can specify the columns you want to retrieve and the table from which to retrieve the data. The syntax for the `SELECT` statement is as follows:

```sql
SELECT column1, column2, ...
FROM table_name;
```

Here is an example of how to select specific columns from a table called `Employees`:

```sql
SELECT FirstName, LastName, HireDate
FROM Employees;
```

### Filtering Data

The `WHERE` clause is used to filter the results based on a specified condition. Here is an example of how to select employees who were hired after January 1, 2020:

```sql
SELECT FirstName, LastName, HireDate
FROM Employees
WHERE HireDate > '2020-01-01';
```

### Sorting Data

The `ORDER BY` clause is used to sort the results in ascending or descending order. Here is an example of how to select employees and sort them by their last name in ascending order:

```sql
SELECT FirstName, LastName, HireDate
FROM Employees
ORDER BY LastName ASC;
```

```sql
-- or in descending order
SELECT FirstName, LastName, HireDate
FROM Employees
ORDER BY LastName DESC;
```

### Distinct Values

The `DISTINCT` keyword is used to retrieve unique values from a column. Here is an example of how to select distinct job titles from a table called `Jobs`:

```sql
SELECT DISTINCT JobTitle
FROM Jobs;
```

### Multiple Conditions

You can use logical operators such as `AND`, `OR`, and `NOT` to combine multiple conditions in the `WHERE` clause. The general syntax for using multiple conditions is as follows:

```sql
SELECT column1, column2, ...
FROM table_name
WHERE condition1 AND|OR condition2;
```

Here is an example of how to select employees who were hired after January 1, 2020, and have a salary greater than 50000:

```sql
SELECT FirstName, LastName, HireDate, Salary
FROM Employees
WHERE HireDate > '2020-01-01' AND Salary > 50000;
```

Or you can use `OR` operator as below:

```sql
SELECT FirstName, LastName, HireDate, Salary
FROM Employees
WHERE HireDate > '2020-01-01' OR Salary > 50000;
```

This SQL selects the FirstName, LastName, HireDate, and Salary of employees from the Employees table where the HireDate is after January 1, 2020, or the Salary is greater than 50000.

The `NOT` operator can be used to exclude certain records. Here is an example of how to select employees who do not work in the department with ID 3:

```sql
SELECT FirstName, LastName, DepartmentID
FROM Employees
WHERE NOT DepartmentID = 3;
```

#### Exercises

1. Write a query to select all employees who work in the 'IT' department.
2. Write a query to select distinct job titles from the `Jobs` table.
3. Write a query to select employees with a salary between 40000 and 80000.

::: {.callout-note collapse="true" title="Solutions" icon="false"}
```sql
-- 1. Employees in 'IT' department
SELECT FirstName, LastName, DepartmentID
FROM Employees
WHERE DepartmentID = (SELECT DepartmentID FROM Departments WHERE DepartmentName = 'IT');

-- 2. Distinct job titles from Jobs table
SELECT DISTINCT JobTitle
FROM Jobs;

-- 3. Employees with salary between 40000 and 80000
SELECT FirstName, LastName, Salary
FROM Employees
WHERE Salary BETWEEN 40000 AND 80000;
```
:::


### Aggregating Data

SQL provides several aggregate functions that allow you to perform calculations on a set of values. Some commonly used aggregate functions include `COUNT()`, `SUM()`, `AVG()`, `MIN()`, and `MAX()`. Here is an example of how to count the number of employees in the `Employees` table:

```sql
SELECT COUNT(*) AS NumberOfEmployees
FROM Employees;
```

This SQL selects the total number of employees from the Employees table and labels the result as NumberOfEmployees. * means all rows.

```sql
-- Example of SUM function
SELECT SUM(Salary) AS TotalSalary
FROM Employees;
```

This SQL selects the total sum of the Salary column from the Employees table and labels the result as TotalSalary.

```sql
-- Example of AVG function
SELECT AVG(Salary) AS AverageSalary
FROM Employees;
```

This SQL selects the average value of the Salary column from the Employees table and labels the result as AverageSalary.

```sql
-- Example of MIN and MAX functions
SELECT MIN(Salary) AS MinimumSalary, MAX(Salary) AS MaximumSalary
FROM Employees;
```

This SQL selects the minimum and maximum values of the Salary column from the Employees table and labels the results as MinimumSalary and MaximumSalary, respectively.

#### Exercises

1. Write a query to select all employees who were hired in the year 2021.
2. Write a query to select distinct locations from the `Departments` table.
3. Write a query to count the total number of employees.
4. Write a query to find the average salary of employees in the `Employees` table.
5. Write a query to select employees and sort them by their hire date in descending order.
6. Write a query to find the maximum and minimum hire dates from the `Employees` table.
7. Write a query to count the number of distinct job titles in the `Jobs` table.

::: {.callout-note collapse="true" title="Solutions" icon="false"}
```sql
-- 1. Employees hired in 2021
SELECT *
FROM Employees
WHERE YEAR(HireDate) = 2021;

-- 2. Distinct locations from Departments table
SELECT DISTINCT Location
FROM Departments;

-- 3. Count number of employees in each department
SELECT COUNT(*) AS TotalEmployees
FROM Employees;

-- 4. Average salary of employees
SELECT AVG(Salary) AS AverageSalary
FROM Employees;

-- 5. Employees sorted by hire date in descending order
SELECT *
FROM Employees
ORDER BY HireDate DESC;

-- 6. Maximum and minimum hire dates
SELECT MIN(HireDate) AS MinimumHireDate, MAX(HireDate) AS MaximumHire
FROM Employees;

-- 7. Count of distinct job titles in Jobs table
SELECT COUNT(DISTINCT JobTitle) AS NumberOfJobTitles
FROM Jobs;
```
:::

### `WHERE` Clause

The `WHERE` clause is used to filter records that meet a certain condition. It can be used with various comparison operators such as `=`, `!=`, `<`, `>`, `<=`, `>=`, and logical operators like `AND`, `OR`, and `NOT`. The general syntax for the `WHERE` clause is as follows:

```sql
SELECT column1, column2, ...
FROM table_name
WHERE condition;
```

Here is an example of how to use the `WHERE` clause to select employees with a salary greater than 50000:

```sql
SELECT FirstName, LastName, Salary
FROM Employees
WHERE Salary > 50000;
```

This SQL selects the FirstName, LastName, and Salary of employees from the Employees table where the Salary is greater than 50000.

#### Exercises

1. Write a query to select employees who were hired before January 1, 2020.
2. Write a query to select employees with the job title 'Manager' and a salary greater than 60000.
3. Write a query to select employees who work in the 'IT' department or have a salary less than 40000.
 
::: {.callout-note collapse="true" title="Solutions" icon="false"}
```sql
-- 1. Employees hired before January 1, 2020
SELECT FirstName, LastName, HireDate
FROM Employees
WHERE HireDate < '2020-01-01';

-- 2. Employees with job title 'Manager' and salary greater than 60000
SELECT FirstName, LastName, Salary
FROM Employees
WHERE JobTitle = 'Manager' AND Salary > 60000;

-- 3. Employees in 'IT' department or salary less than 40000
SELECT FirstName, LastName, DepartmentID, Salary
FROM Employees
WHERE DepartmentID = (SELECT DepartmentID FROM Departments WHERE DepartmentName = 'IT') OR Salary < 40000;
```
:::

### `Group By` Clause

The `GROUP BY` clause is used to group rows that have the same values in specified columns into summary rows. It is often used with aggregate functions to perform calculations on each group of data. The general syntax for the `GROUP BY` clause is as follows:

```sql
SELECT column1, aggregate_function(column2)
FROM table_name
GROUP BY column1;
```

Here is an example of how to use the `GROUP BY` clause to count the number of employees in each department:

```sql
SELECT DepartmentID, COUNT(*) AS NumberOfEmployees
FROM Employees
GROUP BY DepartmentID;
```

This SQL selects the DepartmentID and counts the number of employees in each department from the Employees table, grouping the results by DepartmentID and labeling the count as NumberOfEmployees.

#### Exercises

1. Write a query to find the total salary for each department.
2. Write a query to count the number of employees in each job title.
3. Write a query to find the average hire date for each department.

::: {.callout-note collapse="true" title="Solutions" icon="false"}
```sql
-- 1. Total salary for each department
SELECT DepartmentID, SUM(Salary) AS TotalSalary
FROM Employees
GROUP BY DepartmentID;

-- 2. Count of employees in each job title
SELECT JobTitle, COUNT(*) AS NumberOfEmployees
FROM Employees
GROUP BY JobTitle;

-- 3. Average hire date for each department
SELECT DepartmentID, AVG(HireDate) AS AverageHireDate
FROM Employees
GROUP BY DepartmentID;
```
:::

### `HAVING` Clause

The `HAVING` clause is used to filter records that meet a certain condition after the `GROUP BY` clause has been applied. It is similar to the `WHERE` clause, but it is used for aggregated data. The general syntax for the `HAVING` clause is as follows:

```sql
SELECT column1, aggregate_function(column2)
FROM table_name
GROUP BY column1
HAVING condition;
```

Here is an example of how to use the `HAVING` clause to filter departments with more than 5 employees:

```sql
SELECT DepartmentID, COUNT(*) AS NumberOfEmployees
FROM Employees
GROUP BY DepartmentID
HAVING COUNT(*) > 5;
```

This SQL selects the DepartmentID and counts the number of employees in each department from the Employees table, grouping the results by DepartmentID and filtering to include only those departments with more than 5 employees.

#### Exercises

1. Write a query to find departments with a total salary greater than 200000.
2. Write a query to find job titles with more than 10 employees.
3. Write a query to find departments with an average hire date before 2021.

::: {.callout-note collapse="true" title="Solutions" icon="false"}
```sql
-- 1. Departments with total salary greater than 200000
SELECT DepartmentID, SUM(Salary) AS TotalSalary
FROM Employees
GROUP BY DepartmentID
HAVING SUM(Salary) > 200000;

-- 2. Job titles with more than 10 employees
SELECT JobTitle, COUNT(*) AS NumberOfEmployees
FROM Employees
GROUP BY JobTitle
HAVING COUNT(*) > 10;

-- 3. Departments with average hire date before 2021
SELECT DepartmentID, AVG(HireDate) AS AverageHireDate
FROM Employees
GROUP BY DepartmentID
HAVING AVG(HireDate) < '2021-01-01';
```
:::

:::{ .callout-tip}
## Confusion between `WHERE` and `HAVING` Clause"
The `WHERE` clause is used to filter rows before any grouping is done, while the `HAVING` clause is used to filter groups after the `GROUP BY` clause has been applied. Use `WHERE` for individual row conditions and `HAVING` for aggregated data conditions.
:::

### NULL Values

In SQL, `NULL` represents a missing or unknown value. It is important to handle `NULL` values properly when querying data. You can use the `IS NULL` and `IS NOT NULL` operators to check for `NULL` values in a column. The general syntax for checking `NULL` values is as follows:

```sql
SELECT column1, column2, ...
FROM table_name
WHERE column_name IS NULL|IS NOT NULL;
```

Here is an example of how to select employees with a `NULL` value in the `ManagerID` column:

```sql
SELECT FirstName, LastName, ManagerID
FROM Employees
WHERE ManagerID IS NULL;
```

#### Exercises

1. Write a query to select employees with a `NULL` value in the `HireDate` column.
2. Write a query to select employees with a non-`NULL` value in the `Salary` column.

::: {.callout-note collapse="true" title="Solutions" icon="false"}
```sql
-- 1. Employees with NULL HireDate
SELECT FirstName, LastName, HireDate
FROM Employees
WHERE HireDate IS NULL;

-- 2. Employees with non-NULL Salary
SELECT FirstName, LastName, Salary
FROM Employees
WHERE Salary IS NOT NULL;
```
:::

### `LIMIT` Clause

The `LIMIT` clause is used to specify the maximum number of records to return in the result set. It is useful when you want to retrieve a subset of data from a larger dataset. The general syntax for the `LIMIT` clause is as follows:

```sql
SELECT column1, column2, ...
FROM table_name
LIMIT number_of_records;
```

Here is an example of how to use the `LIMIT` clause to select the first 10 employees from the `Employees` table:

```sql
SELECT *
FROM Employees
LIMIT 10;
```

::: {.callout-tip}
## Note on SQL Dialects
Not all SQL databases support the `LIMIT` clause. For example, in Microsoft SQL Server, you would use the `SELECT TOP` keyword instead. Use AI to check the syntax for your specific database system.
:::

#### Exercises

1. Write a query to select the first 5 departments from the `Departments` table.
2. Write a query to select the first 3 employees with the highest salaries.

::: {.callout-note collapse="true" title="Solutions" icon="false"}
```sql
-- 1. First 5 departments
SELECT *  
FROM Departments
LIMIT 5;

-- 2. First 3 employees with highest salaries
SELECT *
FROM Employees
ORDER BY Salary DESC
LIMIT 3;
```
:::


### `LIKE` Operator

The `LIKE` operator is used in the `WHERE` clause to search for a specified pattern in a column. It is often used with wildcard characters such as `%` (which represents zero or more characters) and `_` (which represents a single character). The general syntax for the `LIKE` operator is as follows:

```sql
SELECT column1, column2, ...
FROM table_name
WHERE column_name LIKE pattern;
```

Here is an example of how to use the `LIKE` operator to select employees whose last name starts with 'S':

```sql
SELECT FirstName, LastName
FROM Employees
WHERE LastName LIKE 'S%';
```

#### Exercises

1. Write a query to select employees whose first name ends with 'n'.
2. Write a query to select employees whose last name contains 'ar'.
3. Write a query to select employees whose first name has 'a' as the last letter.

::: {.callout-note collapse="true" title="Solutions" icon="false"}
```sql
-- 1. Employees whose first name ends with 'n'
SELECT FirstName, LastName
FROM Employees
WHERE FirstName LIKE '%n';

-- 2. Employees whose last name contains 'ar'
SELECT FirstName, LastName
FROM Employees
WHERE LastName LIKE '%ar%';

-- 3. Employees whose first name has 'a' as the last letter
SELECT FirstName, LastName
FROM Employees
WHERE FirstName LIKE '%a';
```
::: 

### `IN` Operator

The `IN` operator is used in the `WHERE` clause to filter records based on a list of specified values. It allows you to specify multiple values in a `WHERE` clause, making it easier to filter data. The general syntax for the `IN` operator is as follows:

```sql
SELECT column1, column2, ...
FROM table_name
WHERE column_name IN (value1, value2, ...);
```

Here is an example of how to use the `IN` operator to select employees who work in departments with IDs 1, 2, or 3:

```sql
SELECT FirstName, LastName, DepartmentID
FROM Employees
WHERE DepartmentID IN (1, 2, 3);
```

#### Exercises

1. Write a query to select employees who have the job titles 'Manager', 'Analyst', or 'Developer'.
2. Write a query to select departments located in 'Sydney', 'Melbourne', or 'Brisbane'.

::: {.callout-note collapse="true" title="Solutions" icon="false"}
```sql
-- 1. Employees with job titles 'Manager', 'Analyst', or 'Developer'
SELECT FirstName, LastName, JobTitle
FROM Employees
WHERE JobTitle IN ('Manager', 'Analyst', 'Developer');

-- 2. Departments located in 'Sydney', 'Melbourne', or 'Brisbane'
SELECT *
FROM Departments
WHERE Location IN ('Sydney', 'Melbourne', 'Brisbane');
```
:::

### `BETWEEN` Operator

The `BETWEEN` operator is used in the `WHERE` clause to filter records within a specified range. It is inclusive, meaning it includes the boundary values. The general syntax for the `BETWEEN` operator is as follows:

```sql
SELECT column1, column2, ...
FROM table_name
WHERE column_name BETWEEN value1 AND value2;
```

Here is an example of how to use the `BETWEEN` operator to select employees with salaries between 40000 and 80000:

```sql
SELECT FirstName, LastName, Salary
FROM Employees
WHERE Salary BETWEEN 40000 AND 80000;
```

#### Exercises

1. Write a query to select employees hired between January 1, 2020, and December 31, 2021.
2. Write a query to select departments with IDs between 2 and 5.

::: {.callout-note collapse="true" title="Solutions" icon="false"}
```sql
-- 1. Employees hired between January 1, 2020, and December 31
SELECT FirstName, LastName, HireDate
FROM Employees
WHERE HireDate BETWEEN '2020-01-01' AND '2021-12-
31';

-- 2. Departments with IDs between 2 and 5
SELECT *
FROM Departments
WHERE DepartmentID BETWEEN 2 AND 5;
```
:::

### Aliases

Aliases are used to give a table or a column a temporary name. This can make your SQL queries easier to read and understand. You can create an alias using the `AS` keyword. The general syntax for creating an alias is as follows:

```sql
SELECT column_name AS alias_name
FROM table_name AS alias_name;
```
Here is an example of how to use aliases to rename columns in the result set:
```sql
SELECT FirstName AS First_Name, LastName AS Last_Name
FROM Employees AS E;
```

This SQL selects the FirstName and LastName columns from the Employees table, renaming them as First_Name and Last_Name in the result set. The Employees table is also given an alias of E for easier reference.

#### Exercises

1. Write a query to select the `DepartmentName` column from the `Departments` table and rename it as `Dept_Name`.
2. Write a query to select the `FirstName` and `LastName` columns from
the `Employees` table and rename them as `FName` and `LName`, respectively.

::: {.callout-note collapse="true" title="Solutions" icon="false"}
```sql
-- 1. Select DepartmentName and rename as Dept_Name
SELECT DepartmentName AS Dept_Name
FROM Departments;

-- 2. Select FirstName and LastName and rename as FName and LName
SELECT FirstName AS FName, LastName AS LName
FROM Employees;
```
:::


